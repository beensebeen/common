public with sharing class RegionTeacherEventsController {
    @AuraEnabled(cacheable=true)
    public static List<Event> getRegionTeacherEvents() {
        Id currentUserId = UserInfo.getUserId();

        // í˜„ì¬ ë¡œê·¸ì¸ ìœ ì €ì˜ Region ì •ë³´ ì¡°íšŒ
        User currentUser = [
            SELECT Region_Zone__c
            FROM User
            WHERE Id = :currentUserId
            LIMIT 1
        ];

        if (currentUser.Region_Zone__c == null) {
            return new List<Event>();
        }

        // ë™ì¼í•œ Region + ë°©ë¬¸êµì‚¬ Role ìœ ì €ë“¤ì˜ Id
        List<User> teachers = [
            SELECT Id
            FROM User
            WHERE Region_Zone__c = :currentUser.Region_Zone__c
              AND UserRole.Name = 'ë°©ë¬¸êµì‚¬'
        ];

        if (teachers.isEmpty()) return new List<Event>();

        // ğŸ“… ì›”~ê¸ˆ ì¼ì • ì¡°íšŒ
        Date today = Date.today();
        Integer dayOfWeek = today.toStartOfWeek().daysBetween(today); // ì›”=0 ~ ì¼=6
        Date monday = today.addDays(-1 * dayOfWeek);
        Date friday = monday.addDays(4);

        return [
            SELECT Id, Subject, StartDateTime, EndDateTime,
                   Owner.Name   // âœ… ë‹´ë‹¹ êµì‚¬ ì´ë¦„ í¬í•¨
            FROM Event
            WHERE OwnerId IN :teachers
              AND StartDateTime >= :monday
              AND StartDateTime <= :friday
            ORDER BY StartDateTime ASC
        ];
    }
}